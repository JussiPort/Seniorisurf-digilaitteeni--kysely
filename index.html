<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Seniorisurf â€“ Minun digilaitteeni</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    html { scroll-behavior: smooth; }
    body.dark { background-color: #0f172a; color: #e2e8f0; }
    .btn { @apply border px-3 py-1.5 rounded; }
    .chip { @apply px-3 py-1 rounded-full border text-sm; }
    .chip-on { @apply bg-emerald-100 border-emerald-300 dark:bg-emerald-900/30 dark:border-emerald-700; }
    .chip-off { @apply bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600; }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 transition-colors">
  <main id="app" class="max-w-4xl mx-auto p-4 sm:p-6"></main>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    /* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
       Kielet (FI / SV / EN)
    â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
    const LANGS = {
      fi: {
        title: "Seniorisurf â€“ Minun digilaitteeni",
        subtitle: "Opintopiiri 2025 Â· TyÃ¶ryhmÃ¤ 1",
        introTitle: "Tervetuloa Seniorisurf-kyselyyn!",
        introBody: `KyselyssÃ¤ kartoitetaan:
â€¢ miksi olet hankkimassa laitetta,
â€¢ miten ja missÃ¤ kÃ¤ytÃ¤t digilaitteita,
â€¢ millaisia ominaisuuksia arvostat,
â€¢ ja mistÃ¤ voisit saada tukea ja neuvontaa hankinnan jÃ¤lkeen.
Lopuksi saat yhteenvedon ja henkilÃ¶kohtaisen suosituksen sekÃ¤ linkkejÃ¤ oman paikkakuntasi ja verkon digiopastukseen.`,
        ui: {
          theme: "Tumma / Vaalea tila",
          big: "Aâ€“A isompi teksti",
          print: "Tulosta / PDF",
          lang: "Kieli",
          clear: "TyhjennÃ¤ lomake",
          back: "Palaa",
          next: "Seuraava",
          start: "Aloita",
          toSummary: "Siirry yhteenvetoon",
          copy: "Kopioi yhteenveto",
          csv: "Vie CSV",
        },
        steps: ["Johdanto","Miksi","Nykyiset laitteet & osaaminen","Mieltymykset","Budjetti & tarpeet","Asuinpaikka & digituki","Yhteenveto"],
        // 1 â€“ Miksi
        whyTitle: "1/5 â€“ Miksi olet hankkimassa uutta laitetta?",
        whyOpts: [
          "Nykyinen laite on vanha tai hidas",
          "Tarvitsen laitteen tyÃ¶skentelyyn tai opiskeluun",
          "Haluan helpottaa asioiden hoitamista verkossa",
          "Haluan pysyÃ¤ yhteydessÃ¤ lÃ¤heisiin",
          "Haluaisin oppia uutta ja pysyÃ¤ ajan tasalla",
          "Haluaisin aloittaa uuden harrastuksen",
          "Muu syy"
        ],
        whyFree: "Kuvaile omin sanoin (valinnainen)",
        whyTip: "ðŸ’¡ Mieti, mitÃ¤ haluat parantaa tai helpottaa.",
        // 2 â€“ Nykyiset & osaaminen & kÃ¤yttÃ¶
        haveTitle: "2/5 â€“ Nykyiset laitteet ja oma osaaminen",
        haveOpts: ["Ei vielÃ¤ lainkaan","Ã„lypuhelin","Tabletti","Kannettava tietokone","PÃ¶ytÃ¤kone","Ã„lykello tai muu mobiililaite"],
        levelTitle: "Miten arvioit omaa osaamistasi?",
        levelOpts: ["Aloittelija","PeruskÃ¤yttÃ¤jÃ¤","Kokenut"],
        useTitle: "Mihin asioihin kÃ¤ytÃ¤t tai haluaisit kÃ¤yttÃ¤Ã¤ digilaitetta? (Valitse useita)",
        useOpts: [
          "Omien asioiden hoitaminen (pankki, Kela, verottaja, liput)",
          "Tiedon hakeminen (ohjeet, harrastukset, uutiset)",
          "Viihde (elokuvat, kirjat, musiikki)",
          "Pelaaminen",
          "Luova tyÃ¶ (kirjoittaminen, kuvankÃ¤sittely, piirtÃ¤minen)",
          "Verkkokurssit ja etÃ¤luennot",
          "Yhteydenpito (WhatsApp, Skype, Facebook jne.)"
        ],
        haveTip: "ðŸ’¡ HelppokÃ¤yttÃ¶isyys on tÃ¤rkein aloittelijalle; tehokkuus aktiivikÃ¤yttÃ¤jÃ¤lle.",
        // 3 â€“ Mieltymykset
        prefTitle: "3/5 â€“ Mieltymykset (liikkuvuus ja nÃ¤yttÃ¶)",
        mobilityTitle: "Kuinka paljon liikut laitteen kanssa?",
        mobilityOpts: ["KÃ¤ytÃ¤n laitetta pÃ¤Ã¤asiassa kotona","Otan laitteen joskus mukaan","Tarvitsen kevyen ja helposti mukana kulkevan laitteen"],
        screenTitle: "Kumpi on sinulle tÃ¤rkeÃ¤mpÃ¤Ã¤?",
        screenOpts: ["Iso ja selkeÃ¤ nÃ¤yttÃ¶ (helppo nÃ¤hdÃ¤ ja kÃ¤yttÃ¤Ã¤)","Kevyt ja kompakti koko (helppo kuljettaa)"],
        prefTip: "ðŸ’¡ Iso nÃ¤yttÃ¶ sopii kotikÃ¤yttÃ¶Ã¶n; kevyt laite liikkuvalle.",
        // 4 â€“ Budjetti & tarpeet
        budTitle: "4/5 â€“ Budjetti ja erityistarpeet",
        budgetTitle: "Paljonko olet valmis sijoittamaan uuteen laitteeseen?",
        budgetOpts: ["Alle 500 â‚¬","500â€“1000 â‚¬","Yli 1000 â‚¬"],
        needTitle: "Onko sinulla erityistarpeita tai toiveita? (valitse useita)",
        needOpts: ["HyvÃ¤ kamera","KynÃ¤tuki","PitkÃ¤ akun kesto","Suuri tallennustila","Pelaamiseen sopiva teho","Suuri ja kirkas nÃ¤yttÃ¶","Kevyt ja helposti mukana kulkeva","Fyysinen nÃ¤ppÃ¤imistÃ¶","EsteettÃ¶myysominaisuudet (Ã¤Ã¤niavustus, suurennus, kontrasti)"],
        budTip: "ðŸ’¡ Valitse budjetti ja vain tÃ¤rkeimmÃ¤t ominaisuudet.",
        // 5 â€“ Asuinpaikka & digituki
        locTitle: "5/5 â€“ Asuinpaikka ja digituki",
        placeLabel: "Asuinpaikka (kaupunki/kunta)",
        supportQ: "HyÃ¶dynnÃ¤tkÃ¶ digitukea tarvittaessa?",
        yes: "KyllÃ¤", maybe:"EhkÃ¤", no:"En",
        locTip: "ðŸ’¡ Digiopastusta lÃ¶ytyy kirjastoista ja jÃ¤rjestÃ¶istÃ¤ (SeniorSurf, Enter ry).",
        // 6 â€“ Yhteenveto
        summaryTitle: "Yhteenveto",
        yourAnswers: "ðŸ§¾ Yhteenveto vastauksistasi",
        adviceTitle: "ðŸ’¡ Suositeltu laitetyyppi",
        altAdvice: "Vaihtoehtoinen tyyppi",
        searchTitle: "ðŸ” Hae verkosta (avautuu uuteen vÃ¤lilehteen)",
        shops: {
          gigantti: "Hae Gigantista",
          verkkis: "Hae Verkkokauppa.comista",
          power: "Hae Powerista",
          dna: "Hae DNA:lta",
          elisa: "Hae Elisalta",
          hintaopas: "Hae Hintaoppaasta"
        },
        footer: "Â© Seniorisurf opintopiiri 2025 Â· Ei kerÃ¤Ã¤ henkilÃ¶tietoja Â· Vastaukset tallennetaan selaimeen"
      },
      sv: {
        title:"Seniorisurf â€“ Min digitala enhet",
        subtitle:"Studiecirkel 2025",
        introTitle:"VÃ¤lkommen till SeniorSurf-enkÃ¤ten!",
        introBody:"Vi kartlÃ¤gger behov, anvÃ¤ndning, preferenser och stÃ¶d. I slutet fÃ¥r du en sammanfattning och sÃ¶klÃ¤nkar.",
        ui:{theme:"MÃ¶rkt / Ljust lÃ¤ge",big:"Aâ€“A stÃ¶rre text",print:"Skriv ut / PDF",lang:"SprÃ¥k",clear:"TÃ¶m formulÃ¤ret",back:"Tillbaka",next:"NÃ¤sta",start:"Starta",toSummary:"GÃ¥ till sammanfattning",copy:"Kopiera",csv:"Exportera CSV"},
        steps:["Intro","VarfÃ¶r","Enheter & kunskap","Preferenser","Budget & behov","Ort & stÃ¶d","Sammanfattning"],
        whyTitle:"1/5 â€“ VarfÃ¶r skaffar du en enhet?",
        whyOpts:["Nuvarande enhet Ã¤r gammal/lÃ¥ngsam","Arbete eller studier","UnderlÃ¤tta e-tjÃ¤nster","HÃ¥lla kontakt","LÃ¤ra mig nytt","Ny hobby","Annan orsak"],
        whyFree:"Beskriv med egna ord",
        whyTip:"ðŸ’¡ Vad vill du fÃ¶rbÃ¤ttra?",
        haveTitle:"2/5 â€“ Nuvarande enheter och kunskap",
        haveOpts:["Inga Ã¤nnu","Smarttelefon","Surfplatta","BÃ¤rbar dator","StationÃ¤r dator","Smartklocka"],
        levelTitle:"Hur bedÃ¶mer du din nivÃ¥?",
        levelOpts:["NybÃ¶rjare","GrundlÃ¤ggande","Erfaren"],
        useTitle:"Vad vill du anvÃ¤nda enheten till? (flera val)",
        useOpts:["E-tjÃ¤nster","InformationssÃ¶kning","UnderhÃ¥llning","Spel","Kreativt arbete","NÃ¤tkurser","Kontakt"],
        haveTip:"ðŸ’¡ Enkelhet hjÃ¤lper nybÃ¶rjare mest.",
        prefTitle:"3/5 â€“ Preferenser (rÃ¶rlighet & skÃ¤rm)",
        mobilityTitle:"Hur mycket rÃ¶r du dig med enheten?",
        mobilityOpts:["Mest hemma","Ibland med","BehÃ¶ver lÃ¤tt att bÃ¤ra"],
        screenTitle:"Vad Ã¤r viktigare?",
        screenOpts:["Stor och tydlig skÃ¤rm","Kompakt och lÃ¤tt"],
        prefTip:"ðŸ’¡ Stor skÃ¤rm passar hemmabruk.",
        budTitle:"4/5 â€“ Budget & behov",
        budgetTitle:"Din budget?",
        budgetOpts:["Under 500 â‚¬","500â€“1000 â‚¬","Ã–ver 1000 â‚¬"],
        needTitle:"SÃ¤rskilda behov",
        needOpts:["Bra kamera","PennstÃ¶d","LÃ¥ng batteritid","Stor lagring","Spelkraft","Stor och ljus skÃ¤rm","LÃ¤tt att bÃ¤ra","Fysiskt tangentbord","TillgÃ¤nglighetsfunktioner"],
        budTip:"ðŸ’¡ VÃ¤lj budget och det viktigaste.",
        locTitle:"5/5 â€“ Ort & stÃ¶d",
        placeLabel:"Ort (stad/kommun)",
        supportQ:"Vill du anvÃ¤nda digitalt stÃ¶d?",
        yes:"Ja", maybe:"Kanske", no:"Nej",
        locTip:"ðŸ’¡ Bibliotek erbjuder ofta digital handledning.",
        summaryTitle:"Sammanfattning",
        yourAnswers:"ðŸ§¾ Ditt sammandrag",
        adviceTitle:"ðŸ’¡ Rekommenderad typ",
        altAdvice:"Alternativ typ",
        searchTitle:"ðŸ” Ã–ppna sÃ¶klÃ¤nkar",
        shops:{gigantti:"SÃ¶k pÃ¥ Gigantti",verkkis:"SÃ¶k pÃ¥ Verkkokauppa.com",power:"SÃ¶k pÃ¥ Power",dna:"SÃ¶k pÃ¥ DNA",elisa:"SÃ¶k pÃ¥ Elisa",hintaopas:"SÃ¶k pÃ¥ Hintaopas"},
        footer:"Â© Seniorisurf 2025"
      },
      en: {
        title:"Senior Surf â€“ My digital device",
        subtitle:"Study Circle 2025",
        introTitle:"Welcome to the SeniorSurf survey!",
        introBody:"Weâ€™ll map your needs, usage, preferences and support options. At the end you get a summary and search links.",
        ui:{theme:"Dark / Light",big:"Aâ€“A larger text",print:"Print / PDF",lang:"Language",clear:"Reset form",back:"Back",next:"Next",start:"Start",toSummary:"Go to summary",copy:"Copy",csv:"Export CSV"},
        steps:["Intro","Why","Devices & skills","Preferences","Budget & needs","Location & support","Summary"],
        whyTitle:"1/5 â€“ Why do you need a new device?",
        whyOpts:["Old or slow device","Work or studies","E-services & admin","Keep in touch","Learn new things","New hobby","Other reason"],
        whyFree:"Describe in your own words",
        whyTip:"ðŸ’¡ What do you want to improve?",
        haveTitle:"2/5 â€“ Current devices and skills",
        haveOpts:["None yet","Smartphone","Tablet","Laptop","Desktop","Smartwatch"],
        levelTitle:"How do you rate your skills?",
        levelOpts:["Beginner","Intermediate","Advanced"],
        useTitle:"What will you use it for? (multiple choices)",
        useOpts:["E-services","Information search","Entertainment","Gaming","Creative work","Online courses","Keeping in touch"],
        haveTip:"ðŸ’¡ Simplicity helps beginners most.",
        prefTitle:"3/5 â€“ Preferences (mobility & screen)",
        mobilityTitle:"How much do you move with the device?",
        mobilityOpts:["Mainly at home","Sometimes with me","Need lightweight portable"],
        screenTitle:"What matters more?",
        screenOpts:["Large & clear screen","Compact & light"],
        prefTip:"ðŸ’¡ Big clear screen suits home use.",
        budTitle:"4/5 â€“ Budget & special needs",
        budgetTitle:"Your budget?",
        budgetOpts:["Under â‚¬500","â‚¬500â€“â‚¬1000","Over â‚¬1000"],
        needTitle:"Special needs",
        needOpts:["Good camera","Pen support","Long battery life","Large storage","Gaming capable","Large bright display","Lightweight portable","Physical keyboard","Accessibility features"],
        budTip:"ðŸ’¡ Choose a budget and only the essentials.",
        locTitle:"5/5 â€“ Location & digital support",
        placeLabel:"City / municipality",
        supportQ:"Would you use digital support if needed?",
        yes:"Yes", maybe:"Maybe", no:"No",
        locTip:"ðŸ’¡ Libraries often offer free digital help.",
        summaryTitle:"Summary",
        yourAnswers:"ðŸ§¾ Your answers",
        adviceTitle:"ðŸ’¡ Recommended type",
        altAdvice:"Alternative type",
        searchTitle:"ðŸ” Search shops (new tab)",
        shops:{gigantti:"Search Gigantti",verkkis:"Search Verkkokauppa.com",power:"Search Power",dna:"Search DNA",elisa:"Search Elisa",hintaopas:"Search Hintaopas"},
        footer:"Â© Senior Surf 2025"
      }
    };

    /* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
       Apurit
    â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
    const load = (k, d) => { try { return JSON.parse(localStorage.getItem(k)) ?? d; } catch { return d; } };
    const save = (k, v) => { try { localStorage.setItem(k, JSON.stringify(v)); } catch {} };

    const Chip = ({label, active, onClick}) =>
      <button onClick={onClick} className={`chip ${active ? 'chip-on' : 'chip-off'}`}>{label}</button>;

    function buildSearchUrls(query){
      const q = encodeURIComponent(query);
      return {
        gigantti: `https://www.google.com/search?q=${q}+site:gigantti.fi`,
        verkkis: `https://www.google.com/search?q=${q}+site:verkkokauppa.com`,
        power: `https://www.google.com/search?q=${q}+site:power.fi`,
        dna: `https://www.google.com/search?q=${q}+site:dna.fi`,
        elisa: `https://www.google.com/search?q=${q}+site:elisa.fi`,
        hintaopas: `https://www.google.com/search?q=${q}+site:hintaopas.fi`,
      };
    }

    /* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
       Sovellus
    â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
    function App(){
      const [lang,setLang] = useState(load('ss-lang','fi'));
      const t = LANGS[lang];
      const [dark,setDark] = useState(load('ss-dark',false));
      const [large,setLarge] = useState(load('ss-large',false));
      const [step,setStep] = useState(load('ss-step',0)); // 0..6

      const [f,setF] = useState(load('ss-form', {
        why:[], whyFree:"",
        have:[], level:"",
        use:[],
        mobility:"", screen:"",
        budget:"", needs:[],
        place:"", support:""
      }));

      useEffect(()=> save('ss-lang',lang),[lang]);
      useEffect(()=> { document.body.classList.toggle('dark', dark); save('ss-dark',dark); },[dark]);
      useEffect(()=> { document.documentElement.style.fontSize = large? '18px':'16px'; save('ss-large',large); },[large]);
      useEffect(()=> save('ss-form',f),[f]);
      useEffect(()=> save('ss-step',step),[step]);

      const toggle = (key, value) => setF(prev=>{
        const set = new Set(prev[key]);
        set.has(value) ? set.delete(value) : set.add(value);
        return {...prev, [key]: Array.from(set)};
      });

      const resetAll = () => {
        localStorage.removeItem('ss-form'); localStorage.removeItem('ss-step');
        setF({why:[], whyFree:"", have:[], level:"", use:[], mobility:"", screen:"", budget:"", needs:[], place:"", support:""});
        setStep(0);
      };

      // â€”â€”â€” suositus: pisteytys
      const scoring = useMemo(()=>{
        const types = ['tabletti','kannettava','pÃ¶ytÃ¤kone','Ã¤lypuhelin'];
        const s = Object.fromEntries(types.map(k=>[k,0]));

        // kÃ¤ytÃ¶t
        const U = t.useOpts;
        f.use.includes(U[4]) && (s.kannettava+=3); // luova tyÃ¶
        f.use.includes(U[5]) && (s.kannettava+=3); // verkkokurssit
        f.use.includes(U[0]) && (s.tabletti+=2);   // asiointi
        f.use.includes(U[1]) && (s.tabletti+=2);   // tiedonhaku
        f.use.includes(U[6]) && (s.Ã¤lypuhelin+=3); // yhteydenpito
        f.use.includes(U[3]) && (s.kannettava+=2); // pelaaminen

        // liikkuvuus & nÃ¤yttÃ¶
        if (f.mobility===t.mobilityOpts[0]) s.pÃ¶ytÃ¤kone+=3;
        if (f.mobility===t.mobilityOpts[2]) s.Ã¤lypuhelin+=3, s.tabletti+=2, s.kannettava+=1;
        if (f.screen===t.screenOpts[0]) s.pÃ¶ytÃ¤kone+=2, s.tabletti+=2, s.kannettava+=1;
        if (f.screen===t.screenOpts[1]) s.Ã¤lypuhelin+=2, s.tabletti+=1;

        // taso
        if (f.level===t.levelOpts[0]) s.tabletti+=3, s.Ã¤lypuhelin+=1;
        if (f.level===t.levelOpts[1]) s.tabletti+=1, s.kannettava+=1;
        if (f.level===t.levelOpts[2]) s.kannettava+=2, s.pÃ¶ytÃ¤kone+=1;

        // budjetti
        if (f.budget===t.budgetOpts[0]) s.tabletti+=1, s.Ã¤lypuhelin+=1;
        if (f.budget===t.budgetOpts[1]) s.kannettava+=1, s.tabletti+=1;
        if (f.budget===t.budgetOpts[2]) s.kannettava+=2, s.pÃ¶ytÃ¤kone+=2;

        // tarpeet
        const keyb = /Fyysinen nÃ¤ppÃ¤imistÃ¶|Fysiskt tangentbord|Physical keyboard/;
        const acc = /EsteettÃ¶myys|TillgÃ¤nglighet|Accessibility/;
        const big = /Suuri ja kirkas nÃ¤yttÃ¶|Stor och ljus skÃ¤rm|Large bright display/;
        const pen = /KynÃ¤tuki|PennstÃ¶d|Pen support/;
        if (f.needs.some(n=>keyb.test(n))) s.kannettava+=2, s.pÃ¶ytÃ¤kone+=2;
        if (f.needs.some(n=>acc.test(n))) s.tabletti+=1, s.Ã¤lypuhelin+=1;
        if (f.needs.some(n=>big.test(n))) s.pÃ¶ytÃ¤kone+=2, s.tabletti+=2;
        if (f.needs.some(n=>pen.test(n))) s.tabletti+=2;

        const sorted = Object.entries(s).sort((a,b)=>b[1]-a[1]);
        const best = sorted[0][0];
        const alt = sorted[1] && (sorted[1][1] >= sorted[0][1]-1) ? sorted[1][0] : null;
        return {score:s, best, alt};
      }, [f, t]);

      const queryForType = (type) => {
        let q = type;
        if (f.budget===t.budgetOpts[0]) q += " alle 500 â‚¬";
        if (f.budget===t.budgetOpts[1]) q += " 500â€“1000 â‚¬";
        if (f.needs.some(n=>/Suuri.*nÃ¤yttÃ¶|Stor.*skÃ¤rm|Large.*display/.test(n))) q += " iso nÃ¤yttÃ¶";
        if (f.needs.some(n=>/Fyysinen nÃ¤ppÃ¤imistÃ¶|Fysiskt tangentbord|Physical keyboard/.test(n))) q += " nÃ¤ppÃ¤imistÃ¶";
        return q;
      };
      const urlsBest = useMemo(()=> buildSearchUrls(queryForType(scoring.best)), [scoring.best, f.budget, f.needs]);
      const urlsAlt  = useMemo(()=> scoring.alt ? buildSearchUrls(queryForType(scoring.alt)) : null, [scoring.alt, f.budget, f.needs]);

      // â€”â€”â€” navigaatio
      const canNext = () => {
        if (step===0) return true;
        if (step===1) return f.why.length>0 || f.whyFree.trim().length>0;
        if (step===2) return f.level!==""; // minimi
        if (step===3) return f.mobility!=="" && f.screen!=="";
        if (step===4) return f.budget!=="";
        if (step===5) return true;
        return true;
      };

      const copySummary = () => {
        const txt = [
          "Yhteenveto â€“ Minun digilaitteeni",
          "",
          `Hankintasyyt: ${f.why.join(', ') || '-'}`,
          `Vapaa kuvaus: ${f.whyFree || '-'}`,
          `Nykyiset laitteet: ${f.have.join(', ') || '-'}`,
          `KÃ¤yttÃ¶tarkoitus: ${f.use.join(', ') || '-'}`,
          `Liikkuvuus: ${f.mobility || '-'}`,
          `NÃ¤yttÃ¶: ${f.screen || '-'}`,
          `KÃ¤yttÃ¤jÃ¤kokemus: ${f.level || '-'}`,
          `Budjetti: ${f.budget || '-'}`,
          `Erityistarpeet: ${f.needs.join(', ') || '-'}`,
          `Asuinpaikka: ${f.place || '-'}`,
          `Digituki: ${f.support || '-'}`,
          "",
          `Suositeltu tyyppi: ${scoring.best}${scoring.alt ? ` (vaihtoehto: ${scoring.alt})` : ""}`
        ].join("\n");
        navigator.clipboard.writeText(txt).then(()=> alert('Yhteenveto kopioitu.'));
      };

      const exportCSV = () => {
        const rows = [
          ['Hankintasyyt', f.why.join(', ')],
          ['Vapaa kuvaus', f.whyFree],
          ['Nykyiset laitteet', f.have.join(', ')],
          ['KÃ¤yttÃ¶tarkoitus', f.use.join(', ')],
          ['Liikkuvuus', f.mobility],
          ['NÃ¤yttÃ¶', f.screen],
          ['KÃ¤yttÃ¤jÃ¤kokemus', f.level],
          ['Budjetti', f.budget],
          ['Erityistarpeet', f.needs.join(', ')],
          ['Asuinpaikka', f.place],
          ['Digituki', f.support],
          ['Suositeltu tyyppi', scoring.best],
          ['Vaihtoehto', scoring.alt || '']
        ];
        const csv = 'KenttÃ¤;Vastaus\n' + rows.map(r=> r.map(v=>`"${(v||'').toString().replaceAll('"','""')}"`).join(';')).join('\n');
        const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href=url; a.download='seniorisurf_kysely.csv'; a.click();
      };

      // â€”â€”â€” UI rungot
      const Stepper = () => (
        <div className="flex flex-wrap gap-2 text-sm mb-3">
          {t.steps.map((s,i)=>(
            <span key={s} className={`px-2 py-1 rounded-full border ${i===step? 'bg-emerald-100 border-emerald-300 dark:bg-emerald-900/30 dark:border-emerald-700':'bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600'}`}>{i}. {s}</span>
          ))}
        </div>
      );

      const Nav = ({showSummaryNext=false}) => (
        <div className="flex justify-between items-center mt-4">
          <button className="btn" onClick={()=> setStep(s=> Math.max(0,s-1))} disabled={step===0}>{t.ui.back}</button>
          <div className="flex gap-2">
            {step<5 && <button className="btn" onClick={()=> setStep(s=> s+1)} disabled={!canNext()}>{t.ui.next}</button>}
            {step===5 && <button className="btn" onClick={()=> setStep(6)} disabled={!canNext()}>{t.ui.toSummary}</button>}
            {step===0 && <button className="btn" onClick={()=> setStep(1)}>{t.ui.start}</button>}
          </div>
        </div>
      );

      // â€”â€”â€” sivun ylÃ¤palkki
      const Header = () => (
        <header className="mb-6">
          <div className="flex flex-col sm:flex-row justify-between items-center gap-3">
            <div>
              <h1 className="text-2xl font-bold">{t.title}</h1>
              <p>{t.subtitle}</p>
            </div>
            <div className="flex gap-2 items-center flex-wrap">
              <button onClick={()=>setDark(v=>!v)} className="btn">{t.ui.theme}</button>
              <button onClick={()=>setLarge(v=>!v)} className="btn">{t.ui.big}</button>
              <button onClick={()=>window.print()} className="btn">{t.ui.print}</button>
              <label>{t.ui.lang}:</label>
              <select value={lang} onChange={e=>setLang(e.target.value)} className="border rounded px-2 py-1">
                <option value="fi">FI</option><option value="sv">SV</option><option value="en">EN</option>
              </select>
              <button onClick={resetAll} className="btn">{t.ui.clear}</button>
            </div>
          </div>
        </header>
      );

      // â€”â€”â€” STEPPISIVUT
      const Intro = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <h2 className="font-semibold text-lg">{t.introTitle}</h2>
          <p className="mt-2 text-slate-700 dark:text-slate-300 whitespace-pre-line">{t.introBody}</p>
          <Nav/>
        </section>
      );

      const Step1 = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <Stepper/>
          <h2 className="font-semibold text-lg mb-2">{t.whyTitle}</h2>
          <div className="flex flex-wrap gap-2">
            {t.whyOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.why.includes(opt)} onClick={()=>toggle('why', opt)} />
            ))}
          </div>
          <label className="block text-sm mt-3">{t.whyFree}</label>
          <textarea rows="3" value={f.whyFree} onChange={e=>setF({...f, whyFree:e.target.value})}
            className="w-full p-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800" />
          <p className="mt-2 text-sm text-slate-600 dark:text-slate-300">ðŸ’¡ {t.whyTip}</p>
          <Nav/>
        </section>
      );

      const Step2 = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <Stepper/>
          <h2 className="font-semibold text-lg mb-2">{t.haveTitle}</h2>
          <p className="font-medium">Laitteet</p>
          <div className="flex flex-wrap gap-2 mb-3">
            {t.haveOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.have.includes(opt)} onClick={()=>toggle('have', opt)} />
            ))}
          </div>
          <p className="font-medium">{t.levelTitle}</p>
          <div className="flex flex-wrap gap-2 mb-3">
            {t.levelOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.level===opt} onClick={()=>setF({...f, level: f.level===opt ? "" : opt})} />
            ))}
          </div>
          <p className="font-medium">{t.useTitle}</p>
          <div className="flex flex-wrap gap-2">
            {t.useOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.use.includes(opt)} onClick={()=>toggle('use', opt)} />
            ))}
          </div>
          <p className="mt-2 text-sm text-slate-600 dark:text-slate-300">ðŸ’¡ {t.haveTip}</p>
          <Nav/>
        </section>
      );

      const Step3 = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <Stepper/>
          <h2 className="font-semibold text-lg mb-2">{t.prefTitle}</h2>
          <p className="font-medium">{t.mobilityTitle}</p>
          <div className="flex flex-wrap gap-2 mb-3">
            {t.mobilityOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.mobility===opt} onClick={()=>setF({...f, mobility: f.mobility===opt ? "" : opt})} />
            ))}
          </div>
          <p className="font-medium">{t.screenTitle}</p>
          <div className="flex flex-wrap gap-2">
            {t.screenOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.screen===opt} onClick={()=>setF({...f, screen: f.screen===opt ? "" : opt})} />
            ))}
          </div>
          <p className="mt-2 text-sm text-slate-600 dark:text-slate-300">ðŸ’¡ {t.prefTip}</p>
          <Nav/>
        </section>
      );

      const Step4 = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <Stepper/>
          <h2 className="font-semibold text-lg mb-2">{t.budTitle}</h2>
          <p className="font-medium">{t.budgetTitle}</p>
          <div className="flex flex-wrap gap-2 mb-3">
            {t.budgetOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.budget===opt} onClick={()=>setF({...f, budget: f.budget===opt ? "" : opt})} />
            ))}
          </div>
          <p className="font-medium">{t.needTitle}</p>
          <div className="flex flex-wrap gap-2">
            {t.needOpts.map(opt=>(
              <Chip key={opt} label={opt} active={f.needs.includes(opt)} onClick={()=>toggle('needs', opt)} />
            ))}
          </div>
          <p className="mt-2 text-sm text-slate-600 dark:text-slate-300">ðŸ’¡ {t.budTip}</p>
          <Nav/>
        </section>
      );

      const Step5 = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <Stepper/>
          <h2 className="font-semibold text-lg mb-2">{t.locTitle}</h2>
          <label className="block text-sm">{t.placeLabel}</label>
          <input value={f.place} onChange={e=>setF({...f, place:e.target.value})}
            className="w-full p-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800" />
          <p className="font-medium mt-3">{t.supportQ}</p>
          <div className="flex flex-wrap gap-2">
            {[t.yes, t.maybe, t.no].map(opt=>(
              <Chip key={opt} label={opt} active={f.support===opt} onClick={()=>setF({...f, support: f.support===opt ? "" : opt})} />
            ))}
          </div>
          <p className="mt-2 text-sm text-slate-600 dark:text-slate-300">ðŸ’¡ {t.locTip}</p>
          <Nav showSummaryNext/>
        </section>
      );

      const Summary = () => (
        <section className="p-4 rounded-2xl border bg-white dark:bg-slate-800">
          <Stepper/>
          <h2 className="font-semibold text-xl mb-2">{t.summaryTitle}</h2>
          <div className="grid md:grid-cols-2 gap-4">
            <div className="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl p-3">
              <h3 className="font-semibold mb-2">{t.yourAnswers}</h3>
              <ul className="text-sm space-y-1">
                <li><b>Hankintasyyt:</b> {f.why.join(', ') || 'â€“'}</li>
                <li><b>Vapaa kuvaus:</b> {f.whyFree || 'â€“'}</li>
                <li><b>Nykyiset laitteet:</b> {f.have.join(', ') || 'â€“'}</li>
                <li><b>KÃ¤yttÃ¶tarkoitus:</b> {f.use.join(', ') || 'â€“'}</li>
                <li><b>Liikkuvuus:</b> {f.mobility || 'â€“'}</li>
                <li><b>NÃ¤yttÃ¶:</b> {f.screen || 'â€“'}</li>
                <li><b>KÃ¤yttÃ¤jÃ¤kokemus:</b> {f.level || 'â€“'}</li>
                <li><b>Budjetti:</b> {f.budget || 'â€“'}</li>
                <li><b>Erityistarpeet:</b> {f.needs.join(', ') || 'â€“'}</li>
                <li><b>Asuinpaikka:</b> {f.place || 'â€“'}</li>
                <li><b>Digituki:</b> {f.support || 'â€“'}</li>
              </ul>
              <div className="flex flex-wrap gap-2 mt-3">
                <button className="btn" onClick={copySummary}>{t.ui.copy}</button>
                <button className="btn" onClick={exportCSV}>{t.ui.csv}</button>
                <button className="btn" onClick={()=>window.print()}>{t.ui.print}</button>
              </div>
            </div>

            <div className="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl p-3">
              <h3 className="font-semibold mb-1">{t.adviceTitle}</h3>
              <p>
                <b>{scoring.best}</b>
                {scoring.alt ? <span> Â· {t.altAdvice}: <b>{scoring.alt}</b></span> : null}
              </p>

              <h4 className="font-semibold mt-3">{t.searchTitle}</h4>
              <div className="grid sm:grid-cols-2 gap-2 mt-2">
                {Object.entries(urlsBest).map(([k,u])=>(
                  <a key={'best-'+k} href={u} target="_blank" rel="noreferrer"
                     className="text-center border rounded-lg px-3 py-2 bg-slate-50 dark:bg-slate-700 hover:bg-slate-100">
                    {t.shops[k]} ({scoring.best})
                  </a>
                ))}
                {urlsAlt && Object.entries(urlsAlt).map(([k,u])=>(
                  <a key={'alt-'+k} href={u} target="_blank" rel="noreferrer"
                     className="text-center border rounded-lg px-3 py-2 bg-slate-50 dark:bg-slate-700 hover:bg-slate-100">
                    {t.shops[k]} ({scoring.alt})
                  </a>
                ))}
              </div>
            </div>
          </div>

          <div className="flex justify-between items-center mt-4">
            <button className="btn" onClick={()=> setStep(5)}>{t.ui.back}</button>
            <button className="btn" onClick={resetAll}>{t.ui.clear}</button>
          </div>
        </section>
      );

      return (
        <div>
          <Header/>
          {step===0 && <Intro/>}
          {step===1 && <Step1/>}
          {step===2 && <Step2/>}
          {step===3 && <Step3/>}
          {step===4 && <Step4/>}
          {step===5 && <Step5/>}
          {step===6 && <Summary/>}
          <footer className="text-xs text-slate-500 mt-6">{t.footer}</footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("app")).render(<App />);
  </script>
</body>
</html>
